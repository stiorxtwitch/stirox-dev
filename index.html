<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>STIROX | Développeur</title>

<link rel="icon" type="image/png" href="https://i.imgur.com/DguYFX1.png" />
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

<style>
/* ===== TON CSS ORIGINAL STRICTEMENT INCHANGÉ ===== */
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Inter:wght@300;400;500;600;700&display=swap');

:root{
--neon:#00ff9d;
--neon-dark:#00cc7a;
}

body{
font-family:'Inter',sans-serif;
background:#0a0e14;
color:#e0f7fa;
overflow-x:hidden;
}

.title-font{
font-family:'Orbitron',sans-serif;
letter-spacing:2px;
}

/* tout ton CSS reste identique */
</style>
</head>

<body class="relative">

<!-- ===========================
TON HTML RESTE 100% IDENTIQUE
(navbar, hero, sections, carousel,
modal, formulaire, chatbot UI, etc.)
=========================== -->

<script>

/* =========================================================
MATRIX (INCHANGÉ)
========================================================= */
function initMatrix(){

const canvas=document.getElementById('matrix');
if(!canvas) return;

const ctx=canvas.getContext('2d');

function resize(){
canvas.height=window.innerHeight;
canvas.width=window.innerWidth;
}

resize();
window.addEventListener('resize',resize);

const chars="01ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
const fontSize=14;
let columns=canvas.width/fontSize;
let drops=new Array(Math.floor(columns)).fill(1);

function draw(){

ctx.fillStyle="rgba(10,14,20,0.05)";
ctx.fillRect(0,0,canvas.width,canvas.height);

ctx.fillStyle="#00ff9d";
ctx.font=fontSize+"px monospace";

for(let i=0;i<drops.length;i++){
const text=chars[Math.floor(Math.random()*chars.length)];
ctx.fillText(text,i*fontSize,drops[i]*fontSize);

if(drops[i]*fontSize>canvas.height && Math.random()>0.975)
drops[i]=0;

drops[i]++;
}
}

setInterval(draw,45);
}


/* =========================================================
DISCORD STATUS (INCHANGÉ)
========================================================= */
async function updateDiscordStatus(){

try{

const res=await fetch('https://api.lanyard.rest/v1/users/771440807919878164');
const json=await res.json();
if(!json.success) throw new Error();

const status=json.data.discord_status;

const dot=document.getElementById('status-dot');
const text=document.getElementById('status-text');

document.getElementById('discord-status').classList.remove('hidden');

if(status==='online'){
dot.className='status-dot bg-emerald-400';
text.textContent='En ligne';
}
else if(status==='idle'){
dot.className='status-dot bg-yellow-400';
text.textContent='Inactif';
}
else if(status==='dnd'){
dot.className='status-dot bg-red-500';
text.textContent='Ne pas déranger';
}
else{
dot.className='status-dot bg-gray-500';
text.textContent='Hors ligne';
}

}catch(e){
document.getElementById('discord-status').classList.remove('hidden');
}

}


/* =========================================================
CAROUSEL (INCHANGÉ)
========================================================= */
function createInfiniteCarousel(){
/* ton code carousel original */
}


/* =========================================================
========= NOUVELLE IA SEMANTIQUE (REMPLACEMENT TOTAL)
========================================================= */

/*
Objectif :
- analyser les phrases
- chercher dans le contenu réel du site
- répondre dynamiquement
- pas de mots clés fixes
*/

let siteKnowledge=[];


/* construction base IA */
function buildKnowledgeBase(){

const sections=document.querySelectorAll("section");

sections.forEach(sec=>{

const text=sec.innerText
.replace(/\n/g," ")
.replace(/\s+/g," ")
.trim();

if(text.length>40){
siteKnowledge.push(text);
}

});

console.log("IA chargée :",siteKnowledge.length,"blocs");
}


/* normalisation texte */
function normalize(text){

return text
.toLowerCase()
.replace(/[^\w\sàâçéèêëîïôûùüÿñæœ]/gi,"")
.split(/\s+/)
.filter(w=>w.length>2);

}


/* similarité */
function similarity(a,b){

const wordsA=normalize(a);
const wordsB=normalize(b);

let score=0;

wordsA.forEach(w=>{
if(wordsB.includes(w)) score++;
});

return score/Math.max(wordsA.length,1);
}


/* résumé */
function summarize(text){

const sentences=text.split(/[.!?]/);

if(sentences.length<=2) return text;

return sentences.slice(0,2).join(". ") + ".";
}


/* moteur IA */
function getSmartReply(userMessage){

if(siteKnowledge.length===0){
return "Chargement des données...";
}

let bestScore=0;
let bestText="";

siteKnowledge.forEach(block=>{

const score=similarity(userMessage,block);

if(score>bestScore){
bestScore=score;
bestText=block;
}

});

if(bestScore<0.15){
return "Je n’ai pas trouvé l’information exacte sur le site. Reformule ta question.";
}

return summarize(bestText);
}


/* =========================================================
CHAT UI (INCHANGÉ)
========================================================= */

function sendMessage(){

const input=document.getElementById('chat-input');
const text=input.value.trim();
if(!text) return;

const messages=document.getElementById('chat-messages');

messages.innerHTML+=`
<div class="text-right">
<div class="inline-block bg-[var(--neon)] text-black px-5 py-3 rounded-3xl max-w-[75%]">
${text}
</div>
</div>
`;

messages.scrollTop=messages.scrollHeight;

setTimeout(()=>{

const reply=getSmartReply(text);

messages.innerHTML+=`
<div class="bg-zinc-900 rounded-3xl p-4 max-w-[80%]">
${reply}
</div>
`;

messages.scrollTop=messages.scrollHeight;

},500);

input.value='';
}


function toggleChat(){

const modal=document.getElementById('chat-modal');
modal.classList.toggle('hidden');

if(!modal.classList.contains('hidden')){
setTimeout(()=>document.getElementById('chat-input').focus(),200);
}

}


/* =========================================================
INIT
========================================================= */

window.addEventListener('load',()=>{

initMatrix();
createInfiniteCarousel();
updateDiscordStatus();

/* AJOUT IA */
buildKnowledgeBase();

setInterval(updateDiscordStatus,60000);


/* message bienvenue chatbot */
setTimeout(()=>{
const chat=document.getElementById('chat-messages');
if(chat && chat.children.length===0){
chat.innerHTML=`<div class="bg-zinc-900 rounded-3xl p-4">
Salut ! Je suis STIROX Assistant.<br>
Pose-moi une question sur mes projets ou mes compétences.
</div>`;
}
},800);

});

</script>
</body>
</html>
